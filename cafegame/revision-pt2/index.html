<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chimera Café</title>
<style>
/* ======================================================
   BODY / THEME
====================================================== */
body {
    margin:0;
    font-family:'Georgia','serif';
    background: linear-gradient(to bottom, #1b0b2f, #3d1f5e);
    color:#eee;
    overflow-x:hidden;
}

/* ======================================================
   GRID TILES
====================================================== */
#tilesGrid {
    display:grid;
    grid-template-columns:repeat(6,1fr);
    grid-gap:2px;
    width:100vw;
    height:100vh;
}
.tile {
    position:relative;
    background:#222;
    overflow:hidden;
    cursor:pointer;
    transition:all 0.3s ease;
}
.tile img {
    width:100%;
    height:100%;
    object-fit:cover;
    filter:blur(1px);
    transition:filter 0.3s ease, transform 0.5s ease, opacity 1s ease;
}
.tile:hover img { 
    filter:blur(0);
    transform:scale(1.02);
}

/* subtle ghost sway */
@keyframes sway {
    0% {transform: translateY(0px);}
    50% {transform: translateY(2px);}
    100% {transform: translateY(0px);}
}
.tile.ghost { animation:sway 8s ease-in-out infinite; opacity:0.95; }

/* ======================================================
   POPUPS / CHAT / MUSIC / ENLIGHTENMENT
====================================================== */
.popupBG, .chatBox, #musicRoom, #cafeMenu, #enlightenmentRealm {
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.85);
    z-index:1000;
    justify-content:center;
    align-items:center;
    overflow:auto;
}
.popupWindow, .chatContent, #musicRoomBox, #cafeMenuBox, #enlightenmentBox {
    background:rgba(30,0,60,0.95);
    padding:20px;
    border-radius:10px;
    color:#eee;
    max-width:500px;
    width:90%;
}
button { margin:5px; padding:8px 12px; border:none; border-radius:4px; cursor:pointer; }

/* ======================================================
   INVENTORY / UMBRELLA DRAWER
====================================================== */
#inventoryDrawer {
    position:fixed;
    right:-360px;
    top:0;
    width:360px;
    height:100%;
    background:linear-gradient(to bottom, #220a33, #3d1f5e);
    color:#fff;
    transition:right 0.5s ease;
    padding:10px;
    z-index:1200;
    overflow:auto;
}
#umbrellaRune {
    position:fixed;
    top:10px;
    right:370px;
    width:50px;
    height:50px;
    background-size:cover;
    cursor:pointer;
    transition:all 0.3s ease, box-shadow 0.5s ease;
    z-index:1300;
}
#umbrellaRune:hover { box-shadow:0 0 20px rgba(255,255,255,0.5); }
.umbrellaOpen { transform:rotate(180deg); }

/* inventory items */
.invItem { border-bottom:1px solid #444; margin:5px 0; padding:3px; }

/* login */
#loginScreen { display:flex; position:fixed; inset:0; justify-content:center; align-items:center; background:rgba(0,0,0,0.9); flex-direction:column; z-index:2000; }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen">
    <h1>Chimera Café</h1>
    <input type="text" id="usernameInput" placeholder="Enter Gamer Name">
    <button onclick="loginUser()">Login</button>
</div>
<button id="logoutBtn" onclick="logoutUser()" style="display:none;position:fixed;top:10px;left:10px;">Logout</button>

<!-- INVENTORY -->
<div id="inventoryDrawer">
    <h3>Your Drawer</h3>
    <div id="inventoryContent"></div>
</div>
<div id="umbrellaRune" onclick="toggleInventory()"></div>

<!-- TILES GRID -->
<div id="tilesGrid">
    <!-- 36 tiles -->
    ${Array.from({length:36}).map((_,i)=>`<div class="tile" data-id="${i+1}" onclick="tileAction(${i+1})"></div>`).join('')}
</div>

<!-- POPUPS -->
<div class="popupBG" id="popupWrapper"><div class="popupWindow" id="popupWindow"></div></div>

<!-- CHATBOXES -->
<div class="chatBox" id="starChat"><div class="chatContent" id="starChatBox"></div></div>
<div class="chatBox" id="hansChat"><div class="chatContent" id="hansChatBox"></div></div>
<div class="chatBox" id="miloChat"><div class="chatContent" id="miloChatBox"></div></div>
<div class="chatBox" id="mikiChat"><div class="chatContent" id="mikiChatBox"></div></div>
<div class="chatBox" id="chariChat"><div class="chatContent" id="chariChatBox"></div></div>

<!-- MUSIC ROOM -->
<div class="popupBG" id="musicRoom"><div id="musicRoomBox"></div></div>

<!-- CAFE MENU -->
<div class="popupBG" id="cafeMenu"><div id="cafeMenuBox"></div></div>

<!-- ENLIGHTENMENT -->
<div class="popupBG" id="enlightenmentRealm"><div id="enlightenmentBox"></div></div>


   <script>
/* ======================================================
    CHARACTER DIALOGUES / QUIZZES / RIDDLES
====================================================== */

/* -----------------------------
    HANS CHAT - TEA SNOB
----------------------------- */
function openHansChat(){
    const hansBox = document.getElementById("hansChatBox");
    hansBox.innerHTML = `
        <p>Hans: Well well well look what the chimera-cat dragged in.</p>
        <p>Hans: Are you here to appreciate true tea or just sniff around like a common tabby?</p>
        <button onclick="hansResponse('yes')">Yes, I love tea.</button>
        <button onclick="hansResponse('no')">No, just exploring.</button>
    `;
    document.getElementById("hansChat").style.display="flex";
}

function hansResponse(answer){
    const hansBox = document.getElementById("hansChatBox");
    if(answer==='yes'){
        hansBox.innerHTML = `
            <p>Hans: Ah, a kindred spirit! Finally, someone with taste.</p>
            <p>Hans: Tell me, do you prefer Earl Grey or English Breakfast?</p>
            <button onclick="hansResponse2('Earl Grey')">Earl Grey</button>
            <button onclick="hansResponse2('English Breakfast')">English Breakfast</button>
        `;
    } else {
        hansBox.innerHTML = `
            <p>Hans: Tsk, sniffing around? Well, you might still learn a thing or two.</p>
            <button onclick="closeHansChat()">Continue</button>
        `;
    }
}

function hansResponse2(choice){
    const hansBox = document.getElementById("hansChatBox");
    hansBox.innerHTML = `
        <p>Hans: ${choice}? Bold choice. Your tea journey begins!</p>
        <p>Hint: Keep an eye out for hidden tea leaves in other tiles...</p>
        <button onclick="closeHansChat()">Close</button>
    `;
    if(!gameState.progress.codex.includes("Hans")) gameState.progress.codex.push("Hans");
    saveGame();
}

function closeHansChat(){
    document.getElementById("hansChat").style.display="none";
}

/* -----------------------------
    STAR CHAT - OWNER
----------------------------- */
function openStarChat(){
    const starBox = document.getElementById("starChatBox");
    starBox.innerHTML = `
        <p>Star: Welcome to the Chimera Café! I’m Star, your gothic guide and romance-reading barista.</p>
        <p>When not running this café, I enjoy Bible study and long dark novels...</p>
        <p>All my chimera siblings (Hans, Milo, Miki, Chari) and I were rescued by Yeshua and started a new life here.</p>
        <button onclick="starFollowup()">Tell me more about the café</button>
        <button onclick="closeStarChat()">Leave</button>
    `;
    document.getElementById("starChat").style.display="flex";
}

function starFollowup(){
    const starBox = document.getElementById("starChatBox");
    starBox.innerHTML = `
        <p>Star: This café is a haven. Each tile you click has secrets, riddles, or portals.</p>
        <p>Tip: Pay attention to the subtle cerulean hints. They may guide you to hidden codex entries or music tracks.</p>
        <button onclick="closeStarChat()">Thanks, Star!</button>
    `;
    if(!gameState.progress.codex.includes("Star")) gameState.progress.codex.push("Star");
    saveGame();
}

function closeStarChat(){
    document.getElementById("starChat").style.display="none";
}

/* -----------------------------
    MILO CHAT - ZEN-CHRISTIAN-TAOIST QUIZZES
----------------------------- */
function openMiloChat(){
    const miloBox = document.getElementById("miloChatBox");
    miloBox.innerHTML = `
        <p>Milo: Greetings. I cultivate both herbs and wisdom.</p>
        <p>Answer my question to step closer to enlightenment:</p>
        <p>Which book in the Bible teaches about salvation through faith in Yeshua?</p>
        <button onclick="miloAnswer('Romans')">Romans</button>
        <button onclick="miloAnswer('Genesis')">Genesis</button>
        <button onclick="miloAnswer('Psalms')">Psalms</button>
    `;
    document.getElementById("miloChat").style.display="flex";
}

function miloAnswer(ans){
    const miloBox = document.getElementById("miloChatBox");
    if(ans==='Romans'){
        miloBox.innerHTML = `
            <p>Milo: Correct. Through faith, one finds salvation and peace.</p>
            <p>Your enlightenment portal is now unlocked!</p>
            <button onclick="openEnlightenment()">Enter Enlightenment Realm</button>
        `;
        gameState.progress.unlockedEnlightenment = true;
        saveGame();
    } else {
        miloBox.innerHTML = `
            <p>Milo: Not quite. Seek the book that speaks directly of salvation through faith.</p>
            <button onclick="closeMiloChat()">Try Again Later</button>
        `;
    }
}

function closeMiloChat(){
    document.getElementById("miloChat").style.display="none";
}

function openEnlightenment(){
    document.getElementById("enlightenmentRealm").style.display="flex";
    document.getElementById("enlightenmentBox").innerHTML = `
        <h2>Enlightenment Realm</h2>
        <p>You have learned about salvation and the path of Yeshua’s guidance.</p>
        <p>Remember: Romans 10:9-10 - “If you declare with your mouth, 'Jesus is Lord,' and believe in your heart that God raised him from the dead, you will be saved.”</p>
        <button onclick="document.getElementById('enlightenmentRealm').style.display='none'">Return</button>
    `;
}

/* -----------------------------
    MIKI CHAT - RIDDLE / MUSIC
----------------------------- */
const mikiRiddleAnswer = "chimera";

function openMikiChat(){
    const mikiBox = document.getElementById("mikiChatBox");
    mikiBox.innerHTML = `
        <p>Miki: Rock on! I have hidden music tracks.</p>
        <p>Solve this riddle to unlock them:</p>
        <p>"Born of many forms, yet one in soul, who am I?"</p>
        <input type="text" id="mikiRiddleInput" placeholder="Answer here">
        <button onclick="checkMikiRiddle()">Submit</button>
    `;
    document.getElementById("mikiChat").style.display="fl

</script>
</body>
</html>
